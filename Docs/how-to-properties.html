<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Renga API: How to work with properties</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Renga API"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="renga_api.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="clipboard.js"></script>
</head>
<body>
<div id="top"  style="background-color: #cbd2db; "><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" >
<table style="background-color: #cbd2db; padding: 10px;">
 <tbody>
 <tr style="height: 56px; width: 100%;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0em;">
   <div id="projectnumber">
   v2.41
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <span id="MSearchSelectExt">&#160;</span>
              <input type="text" id="MSearchField" name="query" value="" placeholder="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('how-to-properties.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to work with properties</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#how-to-properties-overview">Overview</a></li>
<li class="level1"><a href="#how-to-properties-create-property">How to create and manage the properties</a><ul><li class="level2"><a href="#autotoc_md37">C++</a></li>
<li class="level2"><a href="#autotoc_md38">C#</a></li>
</ul>
</li>
<li class="level1"><a href="#how-to-properties-set-value">How to set the property value</a><ul><li class="level2"><a href="#autotoc_md39">C++</a></li>
<li class="level2"><a href="#autotoc_md40">C#</a></li>
</ul>
</li>
<li class="level1"><a href="#how-to-properties-related-samples">Related samples</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_pages_2how-to-properties"></a></p>
<h1><a class="anchor" id="how-to-properties-overview"></a>
Overview</h1>
<p>The object property mechanism available in Renga allows to attach arbitrary properties to objects. Renga itself does not interpret such properties, but stores them in the project and provides access to their values. You can learn more about object properties in <a href="http://help.rengabim.com/#object_properties.htm">Renga help</a>.</p>
<p>Renga API provides two main interfaces to work with the properties. To create and manage object properties in the project use the <a class="el" href="interface_i_property_manager.html" title="Represents a Property Manager.">IPropertyManager</a> interface, available via IProject::GetPropertyManager(). To get or set property values for a given object use the <a class="el" href="interface_i_property_container.html" title="Represents a property container.">IPropertyContainer</a> interface, available via the <a class="el" href="interface_i_model_object.html#aeae83678a70c761c3fe1219fcef24f85" title="Returns the property container interface for the object.">IModelObject::GetProperties()</a> method.</p>
<h1><a class="anchor" id="how-to-properties-create-property"></a>
How to create and manage the properties</h1>
<h2><a class="anchor" id="autotoc_md37"></a>
C++</h2>
<div class="fragment"><div class="line"><span class="keyword">auto</span> pPropertyManager = pProject-&gt;GetPropertyManager();</div>
<div class="line"> </div>
<div class="line">Renga::PropertyDescription propertyDescription;</div>
<div class="line">propertyDescription.Name = L<span class="stringliteral">&quot;Sample property&quot;</span>;</div>
<div class="line">propertyDescription.Type = Renga::PropertyType_String;</div>
<div class="line"> </div>
<div class="line">GUID attributeUuid;</div>
<div class="line">::CoCreateGuid(&amp;attributeUuid);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> pOperation = pProject-&gt;CreateOperation();</div>
<div class="line">pOperation-&gt;Start();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register the property in Renga:</span></div>
<div class="line"><span class="keyword">auto</span> hr = pPropertyManager-&gt;RegisterProperty(attributeUuid, propertyDescription);</div>
<div class="line"><span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Assign the property to the Level object type:</span></div>
<div class="line">hr = pPropertyManager-&gt;AssignPropertyToType(attributeUuid, <a class="code hl_variable" href="group___object_types.html#ga63e86027aceebfe1d00366108c7d5a38">Renga::ObjectTypes::Level</a>);</div>
<div class="line"><span class="keywordflow">if</span> (FAILED(hr))</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"> </div>
<div class="line">pOperation-&gt;Apply();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// All levels in the project now have the property named &quot;Sample property&quot;.</span></div>
<div class="ttc" id="agroup___object_types_html_ga63e86027aceebfe1d00366108c7d5a38"><div class="ttname"><a href="group___object_types.html#ga63e86027aceebfe1d00366108c7d5a38">Renga::ObjectTypes::Level</a></div><div class="ttdeci">const GUID Level</div><div class="ttdoc">Level object type.</div><div class="ttdef"><b>Definition</b> ObjectTypes.h:37</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md38"></a>
C#</h2>
<div class="fragment"><div class="line">Renga.PropertyDescription propertyDescription = <span class="keyword">new</span> Renga.PropertyDescription();</div>
<div class="line">propertyDescription.Name = <span class="stringliteral">&quot;Sample property&quot;</span>;</div>
<div class="line">propertyDescription.Type = Renga.PropertyType.PropertyType_String;</div>
<div class="line"> </div>
<div class="line">Guid attributeUuid = Guid.NewGuid();</div>
<div class="line"> </div>
<div class="line">Renga.IOperation operation = project.CreateOperation();</div>
<div class="line">operation.Start();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register property in Renga:</span></div>
<div class="line">propertyManager.RegisterProperty(attributeUuid, propertyDescription);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Assign property to the Level object type:</span></div>
<div class="line">propertyManager.AssignPropertyToType(attributeUuid, Renga.ObjectTypes.Level);</div>
<div class="line"> </div>
<div class="line">operation.Apply();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// All levels in the project now have the property named &quot;Sample property&quot;.</span></div>
</div><!-- fragment --><h1><a class="anchor" id="how-to-properties-set-value"></a>
How to set the property value</h1>
<p>To set the value of the property use the <a class="el" href="interface_i_operation.html" title="This class contains functions to edit a Renga project.">IOperation</a> interface. Note that Renga only allows to alter objects between calls to <a class="el" href="interface_i_operation.html#a3c185a1148eabd1172fe80b3cee778f6" title="Starts an operation.">IOperation::Start()</a> and <a class="el" href="interface_i_operation.html#a53509803ec742119c575edeb0e63af6e" title="Commits the changes made to objects.">IOperation::Apply()</a>.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
C++</h2>
<div class="fragment"><div class="line">Renga::IModelPtr pModel = pProject-&gt;GetModel();</div>
<div class="line">Renga::IModelObjectCollectionPtr pModelObjectCollection = pModel-&gt;GetObjects();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> pOperation = pProject-&gt;CreateOperation();</div>
<div class="line">pOperation-&gt;Start();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pModelObjectCollection-&gt;Count; ++i)</div>
<div class="line">{</div>
<div class="line">  Renga::IModelObjectPtr pModelObject = pModelObjectCollection-&gt;GetByIndex(i);</div>
<div class="line">  <span class="keywordflow">if</span> (pModelObject-&gt;GetObjectType() == <a class="code hl_variable" href="group___object_types.html#ga63e86027aceebfe1d00366108c7d5a38">Renga::ObjectTypes::Level</a>)</div>
<div class="line">  {</div>
<div class="line">    Renga::IPropertyContainerPtr pPropertyContainer = pModelObject-&gt;GetProperties();</div>
<div class="line">    pPropertyContainer-&gt;Get(attributeUuid)-&gt;SetStringValue(L<span class="stringliteral">&quot;Test value&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line">pOperation-&gt;Apply();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
C#</h2>
<div class="fragment"><div class="line">Renga.IModel model = project.Model;</div>
<div class="line">Renga.IModelObjectCollection modelObjectCollection = model.GetObjects();</div>
<div class="line">Renga.IOperation operation = project.CreateOperation();</div>
<div class="line"> </div>
<div class="line">operation.Start();</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; modelObjectCollection.Count; ++i)</div>
<div class="line">{</div>
<div class="line">  Renga.IModelObject modelObject = modelObjectCollection.GetByIndex(i);</div>
<div class="line">  <span class="keywordflow">if</span> (modelObject.ObjectType == Renga.ObjectTypes.Level)</div>
<div class="line">  {</div>
<div class="line">    Renga.IPropertyContainer propertyContainer = modelObject.GetProperties();</div>
<div class="line">    propertyContainer.Get(attributeUuid).SetStringValue(<span class="stringliteral">&quot;Test value&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">operation.Apply();</div>
</div><!-- fragment --><h1><a class="anchor" id="how-to-properties-see-also"></a>
See also</h1>
<ul>
<li><a class="el" href="interface_i_property_manager.html">IPropertyManager</a></li>
<li><a class="el" href="interface_i_property_container.html">IPropertyContainer</a></li>
<li><a class="el" href="interface_i_property.html">IProperty</a></li>
<li><a class="el" href="interface_i_model_object.html">IModelObject</a></li>
<li><a class="el" href="interface_i_operation.html">IOperation</a></li>
<li><a class="el" href="interface_i_project.html">IProject</a></li>
</ul>
<h1><a class="anchor" id="how-to-properties-related-samples"></a>
Related samples</h1>
<ul>
<li>ObjectProperties </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen-->
<!--BEGIN FOOTER-->
<div id="nav-path" class="navpath">
    <ul>
      <li class="footer"><a href="https://help.rengabim.com/" target="blank">Renga</a> | <a href="https://github.com/RengaSoftware" target="blank">Renga Software on GitHub</a> | <a href="doxygen_crawl.html">Generated by </a><a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.10.0 </li>
    </ul>
</div>
<!--END FOOTER-->
<!-- end header part -->
