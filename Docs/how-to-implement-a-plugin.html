<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Renga API: How to implement a plugin</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Renga API"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="renga_api.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="clipboard.js"></script>
</head>
<body>
<div id="top"  style="background-color: #cbd2db; "><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" >
<table style="background-color: #cbd2db; padding: 10px;">
 <tbody>
 <tr style="height: 56px; width: 100%;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0em;">
   <div id="projectnumber">
   v2.41
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <span id="MSearchSelectExt">&#160;</span>
              <input type="text" id="MSearchField" name="query" value="" placeholder="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('how-to-implement-a-plugin.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to implement a plugin</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#implementing-a-plugin-overview">Overview</a></li>
<li class="level1"><a href="#plugin-system-overview">Plugin system overview</a></li>
<li class="level1"><a href="#description-file-contents">Description file contents</a></li>
<li class="level1"><a href="#what-do-i-need">What do I need to use the Renga API?</a></li>
<li class="level1"><a href="#how-to-create-plugin-cs">How to create a new plugin in C#</a></li>
<li class="level1"><a href="#how-to-create-plugin-cpp">How to create a new plugin in C++</a></li>
<li class="level1"><a href="#how-to-install-plugin">How to install a plugin</a></li>
<li class="level1"><a href="#if-the-plugin-does-not-load">If the plugin doesn&#39;t load</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_pages_2how-to-implement-a-plugin"></a></p>
<h1><a class="anchor" id="implementing-a-plugin-overview"></a>
Overview</h1>
<p>This page describes the design of Renga's plugin system and contains the instructions to help you author Renga plugins. Please see the sample plugin implementations in <code>[RengaCOMSDK dir]/Samples</code>.</p>
<h1><a class="anchor" id="plugin-system-overview"></a>
Plugin system overview</h1>
<p>A basic Renga plugin consists of:</p><ul>
<li>the plugin's binary file, which is a regular Windows dynamic-link library or a .NET assembly.</li>
<li>the description file - an XML file named with the <code>.rndesc</code> extension, which contains plugin description and loading instructions.</li>
</ul>
<p>Each description file should be placed into its own subdirectory in the &lsquo;Plugins&rsquo; subdirectory of Renga's installation folder. Names of the description file should match the plugin's folder name. For example, for a plugin located in <code>[RengaInstallation]/Plugins/Sample</code> folder, the description file should be <code>[RengaInstallation]/Plugins/Sample/Sample.rndesc</code>.</p>
<p>All plugins are loaded into the Renga process on application start and are unloaded on exit.</p>
<h1><a class="anchor" id="description-file-contents"></a>
Description file contents</h1>
<p>The plugin description file contents are as follows:</p>
<div class="fragment"><div class="line">&lt;RengaPlugin&gt;</div>
<div class="line">   &lt;Name&gt;Sample Plugin&lt;/Name&gt;                       &lt;!-- Displayed plugin name --&gt;</div>
<div class="line">   &lt;Version&gt;1.0&lt;/Version&gt;                           &lt;!-- Plugin version --&gt;</div>
<div class="line">   &lt;Copyright&gt;Copyright text&lt;/Copyright&gt;            &lt;!-- Copyright information --&gt;</div>
<div class="line">   &lt;RequiredAPIVersion&gt;2.30&lt;/RequiredAPIVersion&gt;    &lt;!-- Minimum required version of Renga API --&gt;</div>
<div class="line">   &lt;PluginType&gt;net&lt;/PluginType&gt;                     &lt;!-- Plugin type (can be in any case) --&gt;</div>
<div class="line">                                                          &lt;!-- &quot;net&quot; or &quot;.net&quot; for plugins written on .NET Framework (C#, C++/CLI) --&gt;</div>
<div class="line">                                                          &lt;!-- &quot;net8&quot; or &quot;.net8&quot; for plugins written on .NET 8 (C#, C++/CLI) --&gt;</div>
<div class="line">                                                          &lt;!-- &quot;cpp&quot;, &quot;vcpp&quot; or &quot;c++&quot; for plugins written on Visual C++. Optional, defaults to &quot;cpp&quot; --&gt;</div>
<div class="line">   &lt;PluginFilename&gt;Sample.dll&lt;/PluginFilename&gt;      &lt;!-- Path to the plugin&#39;s binary file, either relative to the folder containing the .rndesc file or an absolute one --&gt;</div>
<div class="line">   &lt;Vendor&gt;Renga&lt;/Vendor&gt;                           &lt;!-- Vendor of the plugin --&gt;</div>
<div class="line">&lt;/RengaPlugin&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="what-do-i-need"></a>
What do I need to use the Renga API?</h1>
<p>The requirements to start using the API are as follows:</p><ul>
<li>Installed Renga;</li>
<li>Renga Software Development Kit (<a href="https://dl.rengabim.com/SDK/RengaSDK.zip">download</a>);</li>
<li>Microsoft Visual Studio 2015 or newer.</li>
</ul>
<h1><a class="anchor" id="how-to-create-plugin-cs"></a>
How to create a new plugin in C#</h1>
<p>To create your own plugin in C#, create a new class library project in Microsoft Visual Studio.</p>
<p>To use the Renga system API, you must add a reference to the Renga COM component. You can do this in two ways:</p><ol type="1">
<li>Add the following entry to your csproj file (used in Samples): <div class="fragment"><div class="line">&lt;ItemGroup&gt;</div>
<div class="line">  &lt;COMFileReference Include=&quot;[RengaCOMSDK dir]/tlb/RengaCOMAPI.tlb&quot;&gt;</div>
<div class="line">  &lt;/COMFileReference&gt;</div>
<div class="line">&lt;/ItemGroup&gt;</div>
</div><!-- fragment --></li>
<li>Add a reference through the <a href="https://learn.microsoft.com/en-us/visualstudio/ide/how-to-add-or-remove-references-by-using-the-reference-manager?view=vs-2022">Reference Manager</a>.</li>
</ol>
<p><b>Attention</b>: The reference to the Renga type library must have the "Embed interop types" property set to False. This is necessary for the interop assembly to be generated when building the plugin. The reason is that the Renga .Net SDK libraries also depends on this assembly.</p>
<p>To create a .Net Framework plugin, you need to add a reference to <code>Renga.NET.PluginUtility.dll</code> to your project. To create a .Net 8 plugin, you need to add a reference to <code>Renga.NET8.PluginUtility.dll</code> from the <code>[RengaCOMSDK dir]/Net</code> folder.</p>
<p>In the library, add a class that implements the <code>Renga.IPlugin</code> interface (both explicit and implicit implementations are supported).</p>
<p>The interface has two methods to implement in the plugin:</p><ul>
<li><code>bool Renga.IPlugin.Initialize(string pluginFolder)</code>, which is called on plugin initialization;</li>
<li><code>void Renga.IPlugin.Stop()</code>, which is called when the plugin is being unloaded.</li>
</ul>
<h1><a class="anchor" id="how-to-create-plugin-cpp"></a>
How to create a new plugin in C++</h1>
<p>To create your own plugin in Visual C++, create a new dynamic-link library (DLL) project in Microsoft Visual Studio.</p>
<p>To generate API types from Renga Type Library add <code>#import &lt;RengaCOMAPI.tlb&gt;</code> to your code. This directive should be placed before any Renga C++ SDK headers or any other headers that use Renga API types.</p>
<p>In the library, add a class implementing <code><a class="el" href="classplugins_1_1_i_plugin.html" title="The interface for plugin.">plugins::IPlugin</a></code>. It has two methods to implement in the plugin:</p><ul>
<li><code>bool <a class="el" href="classplugins_1_1_i_plugin.html#add810502d1e0b8e4973d915347284ca0" title="This function is called on plugin initialization.">plugins::IPlugin::initialize(const wchar_t* pluginPath)</a></code>, which is called on plugin initialization;</li>
<li><code>void <a class="el" href="classplugins_1_1_i_plugin.html#a0efff8623a2fb79dad94a96dcf16d966" title="This function is called on plugin unloading.">plugins::IPlugin::stop()</a></code>, which is called when the plugin is being unloaded.</li>
</ul>
<p>Then place the <code>EXPORT_PLUGIN(YourPluginClassName);</code> macro after the plugin class declaration.</p>
<h1><a class="anchor" id="how-to-install-plugin"></a>
How to install a plugin</h1>
<p>You need to place the plugin's description file into the corresponding directory of Renga's installation (see the <a class="el" href="#plugin-system-overview">Plugin system overview</a> section above). Any other files, including the plugin binary itself, may be placed arbitrarily. Renga locates the binary file depending on the path stated in the <code>PluginFilename</code> tag of the description file.</p>
<p>Remember to deploy the <code>Renga.NET.PluginUtility.dll</code> assembly (for .NET Framework plugins) or <code>Renga.NET8.PluginUtility.dll</code> assembly (for .NET 8 plugins) and any other resources your plugin might depend on.</p>
<p>You may also want to create your own installer for the plugin. In this case, you should determine the location of the Renga installation.</p>
<p>You can determine it using the "InstallLocation" attribute in the following registry key: HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall{5129DC7E-FC1E-45DD-B9C9-82940798C85E} for Renga Standard HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall{AD5DA106-F1CF-453A-9E44-510164E2F932} for Renga Professional</p>
<h1><a class="anchor" id="if-the-plugin-does-not-load"></a>
If the plugin doesn't load</h1>
<p>If some errors prevent the plugin from loading successfully, you can check the application log for details. The log is stored in <code>localappdata%\Renga Software\Renga\AecApp.log</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen-->
<!--BEGIN FOOTER-->
<div id="nav-path" class="navpath">
    <ul>
      <li class="footer"><a href="https://help.rengabim.com/" target="blank">Renga</a> | <a href="https://github.com/RengaSoftware" target="blank">Renga Software on GitHub</a> | <a href="doxygen_crawl.html">Generated by </a><a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.10.0 </li>
    </ul>
</div>
<!--END FOOTER-->
<!-- end header part -->
