<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Renga API: How to use Renga as a local server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
  /* @license-end */
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Renga API"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="renga_api.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="clipboard.js"></script>
</head>
<body>
<div id="top"  style="background-color: #cbd2db; "><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" >
<table style="background-color: #cbd2db; padding: 10px;">
 <tbody>
 <tr style="height: 56px; width: 100%;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0em;">
   <div id="projectnumber">
   v2.41
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.html" method="get">
              <span id="MSearchSelectExt">&#160;</span>
              <input type="text" id="MSearchField" name="query" value="" placeholder="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('how-to-local-server.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">How to use Renga as a local server</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#how-to-local-server-overview">Overview</a></li>
<li class="level1"><a href="#how-to-local-server-managing-application-interface">Managing instances of the Application interface</a></li>
<li class="level1"><a href="#how-to-local-server-managing-lifetime">Managing the lifetime of the Renga process</a></li>
<li class="level1"><a href="#how-to-local-server-gui-visibility">Visibility of Renga&#39;s user interface</a></li>
<li class="level1"><a href="#how-to-local-server-client-example">Local client example</a><ul><li class="level2"><a href="#autotoc_md23">C++</a></li>
<li class="level2"><a href="#autotoc_md24">C#</a></li>
</ul>
</li>
<li class="level1"><a href="#how-to-local-server-see-also">See also</a></li>
<li class="level1"><a href="#how-to-local-server-samples">Related samples</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_pages_2how-to-local-server"></a></p>
<h1><a class="anchor" id="how-to-local-server-overview"></a>
Overview</h1>
<p>Since Renga API is built upon the COM technology, ways to access its functionality are not limited to writing plugins that run within Renga's process. Standalone applications can interoperate with Renga (running it as a local COM server), pretty much like a plugin does, except for a few differences discussed below.</p>
<h1><a class="anchor" id="how-to-local-server-managing-application-interface"></a>
Managing instances of the Application interface</h1>
<ul>
<li>To get an Application instance in a local client application, the dwClsContext argument in the call to CoCreateInstance() should be compatible with CLSCTX_LOCAL_SERVER;</li>
<li>Unlike a plugin, a local client application can only get a single Application instance per Renga process. Subsequent requests will launch new Renga instances.</li>
</ul>
<h1><a class="anchor" id="how-to-local-server-managing-lifetime"></a>
Managing the lifetime of the Renga process</h1>
<ul>
<li>The Renga process that was launched by COM upon request of a local client doesn't quit automatically when the last reference to the Application instance is released.</li>
<li>It is possible to terminate Renga manually via <a class="el" href="interface_i_application.html#aa1aeffbaeab8733462961aad54f83ea1" title="Quits Renga.">IApplication::Quit()</a>, which is equivalent to manually quitting the usual way.</li>
</ul>
<h1><a class="anchor" id="how-to-local-server-gui-visibility"></a>
Visibility of Renga's user interface</h1>
<p>When launched by COM, Renga starts in invisible mode. To make its GUI visible (and accessible) for the user, an explicit call to IApplication::SetVisible() is required.</p>
<h1><a class="anchor" id="how-to-local-server-client-example"></a>
Local client example</h1>
<h2><a class="anchor" id="autotoc_md23"></a>
C++</h2>
<div class="fragment"><div class="line">CoInitialize(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="keyword">auto</span> renga = Renga::CreateApplication(CLSCTX_LOCAL_SERVER);</div>
<div class="line">renga-&gt;PutVisible(VARIANT_TRUE);</div>
<div class="line"> </div>
<div class="line">renga-&gt;OpenProject(bstr_t(argv[1]));</div>
<div class="line">... <span class="comment">// use Renga someway</span></div>
<div class="line">renga-&gt;CloseProject(VARIANT_TRUE);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Quit explicitly:</span></div>
<div class="line">renga-&gt;Quit();</div>
<div class="line">CoUninitialize();</div>
</div><!-- fragment --><p>The other way is to use RAII:</p>
<div class="fragment"><div class="line">CoInitialize(<span class="keyword">nullptr</span>);</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">auto</span> renga = Renga::CreateApplication(CLSCTX_LOCAL_SERVER);</div>
<div class="line">    renga-&gt;CloseProject(VARIANT_TRUE);</div>
<div class="line"> </div>
<div class="line">    renga-&gt;OpenProject(bstr_t(argv[1]));</div>
<div class="line">    ... <span class="comment">// use Renga someway</span></div>
<div class="line">    renga-&gt;CloseProject(VARIANT_TRUE);</div>
<div class="line">}</div>
<div class="line">CoUninitialize();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md24"></a>
C#</h2>
<div class="fragment"><div class="line">var renga = <span class="keyword">new</span> Renga.Application(); <span class="comment">// Same as plugin. .NET COM interop layer manages the difference itself.</span></div>
<div class="line">renga.Visible = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">renga.OpenProject(args[0]);</div>
<div class="line">... <span class="comment">// Use Renga someway</span></div>
<div class="line">renga.CloseProject(<span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Quit explicitly:</span></div>
<div class="line">renga.Quit();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ...or release the COM reference manually:</span></div>
<div class="line">System.Runtime.InteropServices.Marshal.ReleaseComObject(renga);</div>
</div><!-- fragment --><h1><a class="anchor" id="how-to-local-server-see-also"></a>
See also</h1>
<ul>
<li><a class="el" href="interface_i_application.html">IApplication</a></li>
</ul>
<h1><a class="anchor" id="how-to-local-server-samples"></a>
Related samples</h1>
<ul>
<li>OpenSaveCloseProject</li>
<li>ExportIfcDwgDxf </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen-->
<!--BEGIN FOOTER-->
<div id="nav-path" class="navpath">
    <ul>
      <li class="footer"><a href="https://help.rengabim.com/" target="blank">Renga</a> | <a href="https://github.com/RengaSoftware" target="blank">Renga Software on GitHub</a> | <a href="doxygen_crawl.html">Generated by </a><a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"></a> 1.10.0 </li>
    </ul>
</div>
<!--END FOOTER-->
<!-- end header part -->
